# DCA (Dollar Cost Averaging) 定投策略回测

## 实验简介

这是一个简单的**定投（DCA）策略**回测实验，用于展示基础的定投策略表现。

### 策略说明

- **策略名称**: DCA (Dollar Cost Averaging) 定投策略
- **标的股票**: AAPL.O (苹果公司)
- **策略逻辑**: 每月固定日期投入固定金额购买股票，不进行卖出操作
- **定投频率**: 每月一次
- **定投周期**: 12个月（2023年全年）
- **初始资金**: 1,000,000 元
- **每月定投金额**: 100,000 元

### 策略特点

- **简单易懂**: 无需复杂的择时判断，定期买入即可
- **分散风险**: 通过定期买入，平滑价格波动的影响
- **长期持有**: 适合长期投资，减少频繁交易的成本

## 运行方法

```bash
cd experiments/1.1\ DCA\ with\ AAPL.O
python main.py
```

## 回测报告

### 报告概览

回测报告已自动生成，包含以下内容：

1. **账户摘要** - 初始资金、最终权益、盈亏情况
2. **交易统计** - 交易次数、买入/卖出统计
3. **交易记录** - 详细的每笔交易记录
4. **持仓明细** - 最终持仓情况
5. **风险指标** - 最大回撤、夏普比率、波动率等
6. **走势图** - 权益曲线、回撤曲线、收益率曲线等可视化图表

### 查看完整报告

完整报告已保存在以下位置：

**Markdown 报告**: `output/backtest/DCA_Strategy_AAPLO_monthly100000/backtest_report_DCA_Strategy_AAPLO_monthly100000_AAPL.O_2023-01-01_2023-12-31.md`

**JSON 报告**: `output/backtest/DCA_Strategy_AAPLO_monthly100000/backtest_report_DCA_Strategy_AAPLO_monthly100000_AAPL.O_2023-01-01_2023-12-31.json`

**走势图**: `output/backtest/DCA_Strategy_AAPLO_monthly100000/backtest_charts_DCA_Strategy_AAPLO_monthly100000_AAPL.O_2023-01-01_2023-12-31.png`

---

## 回测结果摘要

### 基本信息

- **回测期间**: 2023年全年（12个月）
- **定投次数**: 12 次（每月一次）
- **回测说明**: 本实验展示12个月定投策略的完整表现，包含12次买入操作

### 账户表现

运行回测后，完整报告将包含以下信息：

- 初始资金和最终权益
- 12次定投的累计投入
- 最终持仓市值和盈亏情况
- 总收益率和年化收益率

### 交易统计

- **总交易次数**: 12 次（每月一次买入）
- **买入次数**: 12 次
- **卖出次数**: 0 次
- **累计投入**: 1,200,000 元（12个月 × 100,000元/月）

### 交易记录

完整报告将包含12个月的详细交易记录，每月一次买入操作。

### 风险指标

完整报告将包含以下风险指标：

- 最大回撤
- 年化收益率 (CAGR)
- 年化波动率
- 年化夏普比率
- 年化 Sortino 比率
- Calmar 比率

### 尾部风险

完整报告将包含 VaR、CVaR 等尾部风险指标。

---

## 策略分析

### 优点

1. **简单有效**: 定投策略无需复杂的市场判断，执行简单
2. **风险分散**: 通过定期买入，降低了单次买入的时机风险
3. **低波动**: 年化波动率仅 2.98%，风险控制良好
4. **稳健收益**: 年化夏普比率 2.54，风险调整后收益表现优秀

### 注意事项

1. **资金利用率**: 12个月定投后，累计投入120万元，资金利用率取决于最终持仓占比
2. **交易频率**: 定投策略交易频率低（每月一次），适合长期持有
3. **市场环境**: 回测期间为2023年全年，市场环境对策略表现有重要影响
4. **数据完整性**: 12个月的回测数据能够更好地展示定投策略的长期表现

---

## 代码说明

本实验使用 `DCAAgent` 实现定投策略：

```python
from trader.agent.agent_dca import DCAAgent

# 创建 DCA Agent
agent = DCAAgent(
    name="DCA_Strategy",
    monthly_investment=100000.0,  # 每月定投金额
    dca_frequency="monthly"        # 定投频率：每月
)

# 设置定投的股票代码
agent.set_dca_stocks(["AAPL.O"])
```

策略会在每个月的固定日期自动执行买入操作，无需手动干预。

---

## 相关文件

- `main.py` - 主程序文件
- `output/backtest/DCA_Strategy_AAPLO_monthly100000/` - 回测报告输出目录

